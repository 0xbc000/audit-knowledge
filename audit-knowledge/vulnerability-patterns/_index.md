# Vulnerability Patterns Index

> 140+ æ¼æ´æ¨¡å¼å¿«é€Ÿç´¢å¼•ï¼ˆå« 75 å€‹ Solodit çœŸå¯¦æ¡ˆä¾‹ï¼‰

## ğŸ“š Solodit çœŸå¯¦æ¡ˆä¾‹åº« â­ NEW

å¾çœŸå¯¦å¯©è¨ˆå’Œ Bug Bounty æ”¶é›†çš„ 75 å€‹é«˜è³ªé‡ findingsï¼š

â†’ **[Solodit Findings Index](solodit-findings/_index.md)**

| é¡åˆ¥ | æ•¸é‡ | åš´é‡æ€§åˆ†ä½ˆ |
|------|------|-----------|
| Arithmetic | 11 | ğŸ”´ 25 Critical |
| Oracle | 9 | ğŸŸ  39 High |
| Access Control | 8 | ğŸŸ¡ 11 Medium |
| Reentrancy | 7 | |
| Token | 7 | |
| å…¶ä»– | 33 | |

---

## æŒ‰åš´é‡æ€§æ’åºçš„å¿…æŸ¥æ¸…å–®

### ğŸ”´ Critical (å¿…æŸ¥)

| ID | æ¨¡å¼ | ä¸€å¥è©±æè¿° | æª”æ¡ˆ |
|----|------|-----------|------|
| AC-1 | Missing Access Control | `set*` å‡½æ•¸æ²’æœ‰ onlyOwner | [access-control](access-control/access-control-patterns.md#1) |
| RE-1 | Classic Reentrancy | å¤–éƒ¨èª¿ç”¨å¾Œæ›´æ–°ç‹€æ…‹ | [reentrancy](reentrancy/reentrancy-patterns.md#1) |
| UP-1 | Uninitialized Proxy | Proxy éƒ¨ç½²å¾Œæ²’èª¿ç”¨ initialize | [upgrade](upgrade/upgrade-proxy-patterns.md#1) |
| UP-3 | Storage Collision | å‡ç´šå¾Œå­˜å„²ä½ˆå±€ä¸ä¸€è‡´ | [upgrade](upgrade/upgrade-proxy-patterns.md#3) |
| V4-1 | Inflation Attack | ç¬¬ä¸€å­˜æ¬¾è€…æ“ç¸± share åƒ¹æ ¼ | [erc4626](erc4626/erc4626-patterns.md#1) |
| OR-14 | TWAP = Spot Price | è‡ªå»º TWAP æ•¸å­¸éŒ¯èª¤å°è‡´ç­‰æ–¼ç¾è²¨ | [oracle](oracle/twap-implementation-errors.md#1) â­NEW |
| DX-1 | Zero Slippage Protection | amountOutMin = 0/1 ç„¡æ»‘é»ä¿è­· | [dex](dex/slippage-protection.md#1) â­NEW |
| LQ-3 | LTV > Liquidation Threshold | å€Ÿæ¬¾ä¸Šé™é«˜æ–¼æ¸…ç®—é–€æª»ï¼Œæ–°å€Ÿæ¬¾ç«‹å³å¯æ¸…ç®— | [liquidation](liquidation/liquidation-patterns.md#3) â­NEW |
| LQ-8 | Flash Loan Liquidation | Flash loan æ“ç¸± oracle è§¸ç™¼æ¸…ç®— | [liquidation](liquidation/liquidation-patterns.md#8) â­NEW |

### ğŸŸ  High (é‡è¦)

| ID | æ¨¡å¼ | ä¸€å¥è©±æè¿° | æª”æ¡ˆ |
|----|------|-----------|------|
| OR-1 | Stale Price | æ²’æª¢æŸ¥ updatedAt | [oracle](oracle/chainlink-security-checklist.md#1) |
| OR-2 | L2 Sequencer Down | L2 æ²’æª¢æŸ¥ Sequencer ç‹€æ…‹ | [oracle](oracle/chainlink-security-checklist.md#2) |
| OR-11 | Flash Crash minAnswer | æ²’æª¢æŸ¥ minAnswer/maxAnswer | [oracle](oracle/chainlink-security-checklist.md#11) |
| RE-2 | ERC721 Callback | onERC721Received é‡å…¥ | [reentrancy](reentrancy/reentrancy-patterns.md#2) |
| RE-4 | Read-Only Reentrancy | View å‡½æ•¸è®€å–ä¸ä¸€è‡´ç‹€æ…‹ | [reentrancy](reentrancy/reentrancy-patterns.md#4) |
| TK-1 | Fee-on-Transfer | å¯¦éš›æ”¶åˆ°é‡‘é¡ < ç™¼é€é‡‘é¡ | [token](token/token-patterns.md#1) |
| TK-2 | Rebasing Token | é¤˜é¡è‡ªå‹•è®ŠåŒ– | [token](token/token-patterns.md#2) |
| MA-1 | Precision Loss | é™¤æ³•åœ¨ä¹˜æ³•ä¹‹å‰ | [math](math/math-patterns.md#1) |
| MA-2 | Rounding Error | å–æ•´æ–¹å‘éŒ¯èª¤ | [math](math/math-patterns.md#2) |
| BL-5 | State Transition Inconsistency | ç‹€æ…‹æ©Ÿè½‰æ›ç¼ºæª¢æŸ¥ï¼Œå…è¨±è·³æ­¥/é‡è¤‡åŸ·è¡Œ | [business-logic](business-logic/state-transition-inconsistency.md) â­NEW |
| LQ-1 | Self-Liquidation | å€Ÿæ¬¾äººè‡ªæˆ‘æ¸…ç®—è³ºå– bonus | [liquidation](liquidation/liquidation-patterns.md#1) â­NEW |
| LQ-2 | Stale Price Liquidation | éæ™‚ oracle åƒ¹æ ¼å°è‡´éŒ¯èª¤æ¸…ç®— | [liquidation](liquidation/liquidation-patterns.md#2) â­NEW |
| LQ-5 | Bad Debt No Socialization | Underwater å€‰ä½ç„¡æ³•æ¸…ç®—ï¼Œå£å¸³å¡åœ¨ç³»çµ±ä¸­ | [liquidation](liquidation/liquidation-patterns.md#5) â­NEW |
| OR-15 | UQ112.112 Mismatch | æ··ç”¨ Uniswap UQ112 å’Œ 1e18 æ ¼å¼ | [oracle](oracle/twap-implementation-errors.md#2) â­NEW |
| DX-2 | No Price Limit | sqrtPriceLimitX96 = 0 | [dex](dex/slippage-protection.md#2) â­NEW |

### ğŸŸ¡ Medium (å¸¸è¦‹)

| ID | æ¨¡å¼ | ä¸€å¥è©±æè¿° | æª”æ¡ˆ |
|----|------|-----------|------|
| AC-4 | First Depositor | ç¬¬ä¸€ç”¨æˆ¶æœ‰ç‰¹æ®Šå„ªå‹¢ | [access-control](access-control/access-control-patterns.md#3) |
| OR-6 | Wrong Decimals | å‡è¨­æ‰€æœ‰ feed éƒ½æ˜¯ 8 decimals | [oracle](oracle/chainlink-security-checklist.md#6) |
| OR-10 | Bridged Asset Depeg | WBTC è„«é‰¤æ²’è™•ç† | [oracle](oracle/chainlink-security-checklist.md#10) |
| TK-3 | Missing Return Value | USDT ä¸è¿”å› bool | [token](token/token-patterns.md#3) |
| TK-4 | Approval Race | éé›¶â†’éé›¶ approve å¤±æ•— | [token](token/token-patterns.md#4) |
| UP-2 | Re-initialization | initialize å¯å¤šæ¬¡èª¿ç”¨ | [upgrade](upgrade/upgrade-proxy-patterns.md#2) |
| V4-4 | Rounding Inconsistency | deposit/withdraw å–æ•´ä¸ä¸€è‡´ | [erc4626](erc4626/erc4626-patterns.md#4) |
| CC-1 | Gas Griefing | è·¨éˆ gas ä¸è¶³ | [cross-chain](cross-chain/gas-griefing.md) |

## æŒ‰å”è­°é¡å‹çš„ç›¸é—œæ¨¡å¼

### Lending Protocol
```
å¿…æŸ¥: OR-1, OR-11, MA-1, MA-2, V4-1, RE-1, LQ-1, LQ-3, LQ-5
å¸¸è¦‹: TK-1, TK-2, AC-1, OR-10, LQ-2, LQ-4, LQ-6, LQ-7
```

### Cross-Chain Bridge
```
å¿…æŸ¥: AC-1, CC-1, UP-1
å¸¸è¦‹: CC-2 (address encoding), CC-3 (fallback), RE-1
```

### DEX/AMM
```
å¿…æŸ¥: MA-1, MA-2, RE-1, TK-1
å¸¸è¦‹: TK-2, OR-1 (if using oracle)
```

### ERC4626 Vault
```
å¿…æŸ¥: V4-1, V4-4, MA-1, RE-1
å¸¸è¦‹: TK-1, TK-2
```

### Upgradeable Contract
```
å¿…æŸ¥: UP-1, UP-2, UP-3, AC-1
å¸¸è¦‹: UP-4 (unauthorized upgrade), UP-5 (selfdestruct)
```

## å®Œæ•´æ¨¡å¼åˆ—è¡¨

### Reentrancy (5)
1. Guard Reset Attack (Wise Lending)
2. ERC721 Callback (AI Arena)
3. onERC721Received State Manipulation (Revert Lend)
4. Read-Only Reentrancy (Blueberry/Balancer)
5. ERC1155 Rental Hijack (reNFT)

### Access Control (5)
1. Missing Access Control on Setter (Decent)
2. External Call Without Authorization (Salty)
3. First Depositor Advantage (Salty)
4. Missing LayerZero Gas Validation (Decent)
5. Unprotected Initialization

### Oracle (15)
1. Stale Price
2. L2 Sequencer Down
3. Same Heartbeat for Multiple Feeds
4. Infrequent Updates
5. VRF Request Confirmation
6. Assuming Price Precision
7. Incorrect Feed Address
8. Front-Running Oracle Updates
9. Unhandled Revert DoS
10. Bridged Asset Depeg
11. Flash Crash minAnswer/maxAnswer
12. Placing Bets After VRF Request
13. Re-requesting VRF
14. TWAP Cumulative Price Cancellation â­ NEW
15. UQ112.112 vs 1e18 Unit Mismatch â­ NEW

â†’ See: `oracle/twap-implementation-errors.md`

### DEX / Swap (6) â­ NEW
1. amountOutMinimum = 0/1 (No Slippage Protection)
2. sqrtPriceLimitX96 = 0 (No Price Limit)
3. deadline = block.timestamp (Useless Deadline)
4. Missing Post-Swap Verification
5. Hardcoded Slippage Tolerance
6. Multi-Hop Slippage Accumulation

â†’ See: `dex/slippage-protection.md`

### ERC4626 (5)
1. First Depositor Inflation Attack
2. Virtual Offset Defense
3. Donation Attack
4. Rounding Direction Inconsistency
5. Preview Function Mismatch

### Upgrade/Proxy (5)
1. Uninitialized Proxy (Wormhole)
2. Re-initialization (AllianceBlock)
3. Storage Layout Collision (Audius)
4. Unauthorized Upgrade (PAID Network)
5. Dangerous selfdestruct/delegatecall (Furucombo)

### Token (15+)
1. Fee-on-Transfer
2. Rebasing Tokens
3. Missing Return Values
4. Approval Race Condition
5. Reentrant Tokens (ERC777)
6. Blocklist Tokens
7. Pausable Tokens
8. Low/High Decimals
9. Upgradable Tokens
10. Flash Mintable Tokens
11. Multiple Token Addresses
12. Revert on Zero Value
13. Non-Standard Return Values
14. Native Currency as ERC20
15. Unusual Permit Functions

### Math (5)
1. Precision Loss (Division Before Multiplication)
2. Rounding Errors
3. Overflow/Underflow
4. Division by Zero
5. Flash Loan Price Manipulation

### Flash Loan (5) â­ NEW
1. Price Oracle Manipulation
2. Governance Flash Loan Attack
3. Reentrancy via Callback
4. Collateral Factor Inflation
5. Empty Pool Attack (ERC4626)

â†’ See: `flash-loan/flash-loan-patterns.md`

### Cross-Chain / Bridge (6) â­ NEW
1. Message Replay Attack
2. Improper Message Verification
3. Sequencer/Relayer Trust Issues
4. Token Mapping Mismatch
5. Finality Assumptions
6. Reentrancy via Bridge Callback

â†’ See: `cross-chain/cross-chain-patterns.md`

### Governance (7)
1. Flash Loan Governance Attack
2. Proposal Spam / Griefing
3. Timelock Bypass
4. Quorum Manipulation
5. Vote Buying / Dark DAOs
6. Delegate Griefing
7. Token Inflation Takeover

â†’ See: `governance/governance-patterns.md`

### Assembly / Low-Level Parsing (5) â­ NEW
1. Missing 32-byte Length Prefix
2. Unmasked mload for Sub-Word Types
3. Inconsistent Offset Tracking
4. Missing Bounds Check
5. Self-Call via Parsed Target

â†’ See: `assembly/assembly-parsing-patterns.md`
