# Access Control Findings (Solodit)

> Missing or improper access control on sensitive functions

## Overview

| ID | Severity | Title | Platform |
|----|----------|-------|----------|
| SOL-007 | ðŸ”´ critical | Missing Access Control on setRouter | Code4rena |
| SOL-008 | ðŸŸ  high | Unprotected Initialize Function | Immunefi |
| SOL-027 | ðŸ”´ critical | LayerZero setTrustedRemote No Access Control | Code4rena |
| SOL-028 | ðŸŸ  high | First Depositor Controls Pool Parameters | Sherlock |
| SOL-053 | ðŸŸ  high | Liquidator Can Seize More Than Allowed | Sherlock |
| SOL-057 | ðŸŸ  high | NFT Approval Not Cleared on Transfer | Sherlock |
| SOL-067 | ðŸŸ  high | Vault Deposit When Paused Still Possible | Code4rena |
| SOL-075 | ðŸ”´ critical | Timelock Execute Without Queue | Code4rena |

---

## SOL-007: Missing Access Control on setRouter

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Code4rena  
**Protocol Type:** Bridge Protocol

### Description
The setRouter() function lacks access control, allowing anyone to change the router address.

### Impact
Attacker can set malicious router and steal all bridged funds.

### Vulnerable Code
```solidity
function setRouter(address _router) external {
    router = _router;  // No access control!
}
```

### Fix
```solidity
function setRouter(address _router) external onlyOwner {
    router = _router;
}
```

---

## SOL-008: Unprotected Initialize Function

**Severity:** ðŸŸ  HIGH  
**Platform:** Immunefi  
**Protocol Type:** Upgradeable Protocol

### Description
Initialize function can be called by anyone, not just the deployer.

### Impact
Attacker can front-run deployment and take ownership.

### Vulnerable Code
```solidity
function initialize(address _owner) external {
    require(owner == address(0), "Already initialized");
    owner = _owner;
}
```

### Fix
```solidity
function initialize(address _owner) external initializer {
    __Ownable_init(_owner);
}
```

---

## SOL-027: LayerZero setTrustedRemote No Access Control

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Code4rena  
**Protocol Type:** Cross-chain Protocol

### Description
Function to set trusted remote chain address lacks owner check.

### Impact
Attacker can add malicious remote, stealing bridged funds.

### Vulnerable Code
```solidity
function setTrustedRemote(uint16 chainId, bytes calldata path) external {
    trustedRemote[chainId] = path;  // No onlyOwner!
}
```

### Fix
```solidity
function setTrustedRemote(uint16 chainId, bytes calldata path) external onlyOwner {
    trustedRemote[chainId] = path;
}
```

---

## SOL-028: First Depositor Controls Pool Parameters

**Severity:** ðŸŸ  HIGH  
**Platform:** Sherlock  
**Protocol Type:** AMM Protocol

### Description
First depositor in new pool can set initial price and parameters.

### Impact
First depositor extracts value from subsequent depositors.

### Vulnerable Code
```solidity
function initializePool(uint256 priceX96) external {
    require(liquidity == 0, "Already initialized");
    sqrtPriceX96 = priceX96;  // Anyone can set initial price
}
```

### Fix
```solidity
function initializePool(uint256 priceX96) external onlyFactory {
    // Only factory can initialize with validated price
}
```

---

## SOL-053: Liquidator Can Seize More Than Allowed

**Severity:** ðŸŸ  HIGH  
**Platform:** Sherlock  
**Protocol Type:** Lending Protocol

### Description
No check that liquidator only seizes up to close factor of debt.

### Impact
Liquidator takes all collateral for partial debt repayment.

### Vulnerable Code
```solidity
function liquidate(address user, uint256 repayAmount) external {
    uint256 seizeTokens = repayAmount * price / collateralPrice;
    // No check that seizeTokens <= maxSeizable
}
```

### Fix
```solidity
require(repayAmount <= debt * closeFactor / 1e18, "Exceeds close factor");
```

---

## SOL-057: NFT Approval Not Cleared on Transfer

**Severity:** ðŸŸ  HIGH  
**Platform:** Sherlock  
**Protocol Type:** NFT Protocol

### Description
Token approvals persist after transfer, allowing previous owner access.

### Impact
Previous approved operator can take NFT from new owner.

### Vulnerable Code
```solidity
function transferFrom(address from, address to, uint256 id) external {
    // Missing: delete tokenApprovals[id]
    ownerOf[id] = to;
}
```

### Fix
```solidity
delete tokenApprovals[id];
```

---

## SOL-067: Vault Deposit When Paused Still Possible

**Severity:** ðŸŸ  HIGH  
**Platform:** Code4rena  
**Protocol Type:** Vault Protocol

### Description
Pause only affects withdraw, not deposit.

### Impact
Users deposit into paused vault, funds stuck.

### Vulnerable Code
```solidity
function withdraw(uint256 assets) external whenNotPaused { ... }
function deposit(uint256 assets) external { ... }  // No pause check
```

### Fix
```solidity
function deposit(uint256 assets) external whenNotPaused { ... }
```

---

## SOL-075: Timelock Execute Without Queue

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Code4rena  
**Protocol Type:** Governance Protocol

### Description
Execute function doesn't verify transaction was queued.

### Impact
Immediate execution bypasses timelock.

### Vulnerable Code
```solidity
function execute(bytes32 txHash) external {
    // Missing: require(queuedAt[txHash] != 0)
    require(block.timestamp >= eta[txHash], "Not ready");
    _execute(txHash);
}
```

### Fix
```solidity
require(queuedAt[txHash] != 0, "Not queued");
```

---


*Imported from Solodit curated findings*
