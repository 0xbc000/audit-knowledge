# Signature Findings (Solodit)

> Cryptographic signature vulnerabilities

## Overview

| ID | Severity | Title | Platform |
|----|----------|-------|----------|
| SOL-015 | ðŸŸ  high | Signature Replay Across Chains | Immunefi |
| SOL-037 | ðŸŸ  high | Missing Nonce in Signature Allows Replay | Immunefi |
| SOL-038 | ðŸŸ¡ medium | ecrecover Returns Zero for Invalid Signature | Code4rena |
| SOL-070 | ðŸ”´ critical | Permit2 SignatureDeadline Not Enforced | Code4rena |

---

## SOL-015: Signature Replay Across Chains

**Severity:** ðŸŸ  HIGH  
**Platform:** Immunefi  
**Protocol Type:** Multi-chain Protocol

### Description
EIP-712 domain separator missing chain ID allows signature replay on other chains.

### Impact
Action authorized on one chain can be replayed on another.

### Vulnerable Code
```solidity
bytes32 DOMAIN_SEPARATOR = keccak256(abi.encode(
    TYPE_HASH,
    NAME_HASH,
    VERSION_HASH
    // Missing: block.chainid
));
```

### Fix
```solidity
bytes32 DOMAIN_SEPARATOR = keccak256(abi.encode(
    TYPE_HASH,
    NAME_HASH,
    VERSION_HASH,
    block.chainid,
    address(this)
));
```

---

## SOL-037: Missing Nonce in Signature Allows Replay

**Severity:** ðŸŸ  HIGH  
**Platform:** Immunefi  
**Protocol Type:** Meta-transaction Protocol

### Description
Signed message lacks nonce, allowing same signature to be used multiple times.

### Impact
Attacker replays authorized action multiple times.

### Vulnerable Code
```solidity
function executeWithSig(bytes calldata data, bytes calldata sig) external {
    address signer = recover(keccak256(data), sig);
    require(signer == owner, "Invalid signer");
    _execute(data);  // Can be called again with same sig
}
```

### Fix
```solidity
mapping(uint256 => bool) public usedNonces;
function executeWithSig(uint256 nonce, bytes calldata data, bytes calldata sig) external {
    require(!usedNonces[nonce], "Nonce used");
    usedNonces[nonce] = true;
    // ... verify and execute
}
```

---

## SOL-038: ecrecover Returns Zero for Invalid Signature

**Severity:** ðŸŸ¡ MEDIUM  
**Platform:** Code4rena  
**Protocol Type:** DeFi Protocol

### Description
ecrecover returns address(0) for invalid signatures instead of reverting.

### Impact
If zero address has special permissions, bypass possible.

### Vulnerable Code
```solidity
address signer = ecrecover(hash, v, r, s);
require(authorized[signer], "Not authorized");  // Passes if signer = 0
```

### Fix
```solidity
address signer = ecrecover(hash, v, r, s);
require(signer != address(0), "Invalid signature");
require(authorized[signer], "Not authorized");
```

---

## SOL-070: Permit2 SignatureDeadline Not Enforced

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Code4rena  
**Protocol Type:** DeFi Protocol

### Description
Protocol checks Permit2 permit but ignores expiration.

### Impact
Old signatures valid indefinitely.

### Vulnerable Code
```solidity
permit2.permit(owner, permitted, signature);
// Not checking: permitted.deadline
```

### Fix
```solidity
require(permitted.deadline >= block.timestamp, "Expired");
```

---


*Imported from Solodit curated findings*
