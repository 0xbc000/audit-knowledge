# Cross Chain Findings (Solodit)

> Cross-chain and bridge vulnerabilities

## Overview

| ID | Severity | Title | Platform |
|----|----------|-------|----------|
| SOL-020 | ðŸ”´ critical | Bridge Message Replay Attack | Immunefi |
| SOL-045 | ðŸ”´ critical | Missing Chain ID in Cross-chain Message | Immunefi |
| SOL-046 | ðŸŸ  high | Bridge Finality Assumption Violated | Code4rena |
| SOL-062 | ðŸ”´ critical | Token Decimal Mismatch Across Chains | Immunefi |
| SOL-063 | ðŸŸ  high | Gas Limit Too Low for Complex Execution | Code4rena |

---

## SOL-020: Bridge Message Replay Attack

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Immunefi  
**Protocol Type:** Bridge Protocol

### Description
Bridge messages lack nonce, allowing same message to be replayed multiple times.

### Impact
Attacker can mint unlimited tokens on destination chain.

### Vulnerable Code
```solidity
function receiveMessage(bytes calldata message, bytes calldata proof) external {
    require(verifyProof(message, proof), "Invalid proof");
    // No replay protection!
    _processMessage(message);
}
```

### Fix
```solidity
mapping(bytes32 => bool) public processedMessages;

function receiveMessage(bytes calldata message, bytes calldata proof) external {
    bytes32 messageHash = keccak256(message);
    require(!processedMessages[messageHash], "Already processed");
    require(verifyProof(message, proof), "Invalid proof");
    processedMessages[messageHash] = true;
    _processMessage(message);
}
```

---

## SOL-045: Missing Chain ID in Cross-chain Message

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Immunefi  
**Protocol Type:** Bridge Protocol

### Description
Bridge message lacks destination chain ID, can be delivered to wrong chain.

### Impact
Funds delivered to unintended chain or stolen.

### Vulnerable Code
```solidity
bytes32 messageHash = keccak256(abi.encode(
    sender,
    recipient,
    amount
    // Missing: targetChainId
));
```

### Fix
```solidity
bytes32 messageHash = keccak256(abi.encode(
    sender,
    recipient,
    amount,
    targetChainId,
    nonce
));
```

---

## SOL-046: Bridge Finality Assumption Violated

**Severity:** ðŸŸ  HIGH  
**Platform:** Code4rena  
**Protocol Type:** Bridge Protocol

### Description
Bridge assumes source chain finality but chain can reorg.

### Impact
Double-spend on destination after source chain reorg.

### Vulnerable Code
```solidity
// Processes message immediately without waiting for finality
function receiveMessage(bytes calldata message) external {
    _processImmediately(message);
}
```

### Fix
```solidity
// Wait for sufficient confirmations before processing
require(sourceBlockNumber + FINALITY_BLOCKS <= currentBlock);
```

---

## SOL-062: Token Decimal Mismatch Across Chains

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Immunefi  
**Protocol Type:** Bridge Protocol

### Description
Token has 18 decimals on source, 6 on destination.

### Impact
Bridging 1 token gives 1e12 tokens on destination.

### Vulnerable Code
```solidity
// Assumes same decimals on both chains
function bridge(uint256 amount) external {
    burn(amount);
    sendMessage(targetChain, amount);  // Same amount, different meaning
}
```

### Fix
```solidity
// Include token decimals in message
// Normalize during bridge
```

---

## SOL-063: Gas Limit Too Low for Complex Execution

**Severity:** ðŸŸ  HIGH  
**Platform:** Code4rena  
**Protocol Type:** Bridge Protocol

### Description
Fixed gas limit insufficient for complex receiver logic.

### Impact
Message delivered but execution fails, funds stuck.

### Vulnerable Code
```solidity
function receiveMessage(bytes calldata data) external {
    (bool success,) = target.call{gas: 100000}(data);  // Fixed gas
    // Complex operations may need more
}
```

### Fix
```solidity
// Allow gas limit to be specified per message
// Or implement retry mechanism
```

---


*Imported from Solodit curated findings*
