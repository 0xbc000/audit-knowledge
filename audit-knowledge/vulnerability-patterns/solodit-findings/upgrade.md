# Upgrade Findings (Solodit)

> Upgradeable contract and proxy vulnerabilities

## Overview

| ID | Severity | Title | Platform |
|----|----------|-------|----------|
| SOL-017 | ðŸ”´ critical | Uninitialized Proxy Implementation | Immunefi |
| SOL-018 | ðŸŸ  high | Storage Collision After Upgrade | Code4rena |
| SOL-041 | ðŸŸ  high | Delegatecall to Arbitrary Address | Immunefi |
| SOL-042 | ðŸ”´ critical | Implementation Contains selfdestruct | Immunefi |
| SOL-074 | ðŸ”´ critical | Transparent Proxy Admin Collision | Immunefi |

---

## SOL-017: Uninitialized Proxy Implementation

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Immunefi  
**Protocol Type:** Upgradeable Protocol

### Description
Implementation contract not initialized, allowing attacker to call initialize and take control.

### Impact
Attacker becomes owner of implementation, potentially corrupting proxy.

### Vulnerable Code
```solidity
// Implementation deployed but initialize() never called
contract Implementation is Initializable {
    function initialize(address owner) external initializer {
        _owner = owner;
    }
}
```

### Fix
```solidity
constructor() {
    _disableInitializers();  // Prevent implementation initialization
}
```

---

## SOL-018: Storage Collision After Upgrade

**Severity:** ðŸŸ  HIGH  
**Platform:** Code4rena  
**Protocol Type:** Upgradeable Protocol

### Description
New implementation changes storage layout, causing variables to read wrong values.

### Impact
Critical values corrupted, potentially draining funds.

### Vulnerable Code
```solidity
// V1: slot 0 = owner
// V2: slot 0 = newVar, slot 1 = owner  // COLLISION!
```

### Fix
```solidity
// Always append new variables, never reorder
// Use storage gaps for future-proofing
uint256[50] private __gap;
```

---

## SOL-041: Delegatecall to Arbitrary Address

**Severity:** ðŸŸ  HIGH  
**Platform:** Immunefi  
**Protocol Type:** Proxy Protocol

### Description
Function allows delegatecall to user-provided address.

### Impact
Attacker can execute arbitrary code in proxy context.

### Vulnerable Code
```solidity
function multicall(address target, bytes calldata data) external {
    target.delegatecall(data);  // Arbitrary delegatecall!
}
```

### Fix
```solidity
// Whitelist allowed targets
require(allowedTargets[target], "Target not allowed");
```

---

## SOL-042: Implementation Contains selfdestruct

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Immunefi  
**Protocol Type:** Upgradeable Protocol

### Description
Implementation contract has selfdestruct that can be called directly.

### Impact
Attacker destroys implementation, bricking all proxies.

### Vulnerable Code
```solidity
function destroy() external onlyOwner {
    selfdestruct(payable(owner));
}
```

### Fix
```solidity
// Never use selfdestruct in implementations
// Or add proxy-only modifier
```

---

## SOL-074: Transparent Proxy Admin Collision

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Immunefi  
**Protocol Type:** Upgradeable Protocol

### Description
Admin slot collides with implementation storage.

### Impact
Upgrade corrupts implementation state.

### Vulnerable Code
```solidity
// Incorrect admin slot calculation
bytes32 ADMIN_SLOT = keccak256("admin");  // Collides!
```

### Fix
```solidity
// Use EIP-1967 slots
bytes32 ADMIN_SLOT = 0xb53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d6103;
```

---


*Imported from Solodit curated findings*
