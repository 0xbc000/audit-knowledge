# Governance Findings (Solodit)

> DAO and governance-related vulnerabilities

## Overview

| ID | Severity | Title | Platform |
|----|----------|-------|----------|
| SOL-016 | ðŸŸ  high | Emergency Function Bypasses Timelock | Code4rena |
| SOL-039 | ðŸŸ  high | Proposal Spam Denial of Service | Sherlock |
| SOL-040 | ðŸ”´ critical | Low Quorum Enables Hostile Takeover | Code4rena |
| SOL-064 | ðŸ”´ critical | Proposal Can Drain Treasury | Code4rena |
| SOL-065 | ðŸŸ  high | Vote Delegation Infinite Loop | Sherlock |

---

## SOL-016: Emergency Function Bypasses Timelock

**Severity:** ðŸŸ  HIGH  
**Platform:** Code4rena  
**Protocol Type:** DAO Protocol

### Description
Emergency functions allow immediate execution of privileged operations without timelock.

### Impact
Compromised admin can drain funds immediately without delay.

### Vulnerable Code
```solidity
function emergencyWithdraw() external onlyOwner {
    // No timelock!
    token.transfer(owner, token.balanceOf(address(this)));
}
```

### Fix
```solidity
function emergencyWithdraw() external onlyOwner {
    require(block.timestamp > emergencyUnlockTime, "Timelock active");
    token.transfer(owner, token.balanceOf(address(this)));
}
```

---

## SOL-039: Proposal Spam Denial of Service

**Severity:** ðŸŸ  HIGH  
**Platform:** Sherlock  
**Protocol Type:** DAO Protocol

### Description
No limit on active proposals allows attacker to spam and prevent legitimate governance.

### Impact
Governance gridlock, unable to pass critical proposals.

### Vulnerable Code
```solidity
function propose(bytes calldata data) external returns (uint256) {
    // No limit on proposals
    proposals[nextId++] = Proposal(data, block.timestamp);
}
```

### Fix
```solidity
require(activeProposals < MAX_ACTIVE_PROPOSALS, "Too many proposals");
require(proposerLastProposal[msg.sender] + COOLDOWN < block.timestamp);
```

---

## SOL-040: Low Quorum Enables Hostile Takeover

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Code4rena  
**Protocol Type:** DAO Protocol

### Description
Quorum set too low relative to circulating supply allows minority takeover.

### Impact
Attacker with 5% of tokens can pass any proposal.

### Vulnerable Code
```solidity
uint256 public constant QUORUM = 1_000_000e18;  // Fixed amount
// But total supply is 100_000_000e18, quorum is only 1%
```

### Fix
```solidity
// Use percentage-based quorum
uint256 quorum = totalSupply * QUORUM_PERCENTAGE / 100;
```

---

## SOL-064: Proposal Can Drain Treasury

**Severity:** ðŸ”´ CRITICAL  
**Platform:** Code4rena  
**Protocol Type:** DAO Protocol

### Description
No validation that proposal actions are reasonable.

### Impact
Malicious proposal can transfer all treasury funds.

### Vulnerable Code
```solidity
function execute(uint256 proposalId) external {
    Proposal memory p = proposals[proposalId];
    require(p.votes > quorum);
    target.call(p.calldata);  // Arbitrary call to any target
}
```

### Fix
```solidity
// Validate targets are approved
// Limit single transaction amounts
```

---

## SOL-065: Vote Delegation Infinite Loop

**Severity:** ðŸŸ  HIGH  
**Platform:** Sherlock  
**Protocol Type:** DAO Protocol

### Description
Circular delegation creates infinite loop in vote counting.

### Impact
Vote counting function reverts, governance frozen.

### Vulnerable Code
```solidity
function getVotes(address user) public view returns (uint256) {
    if (delegates[user] != address(0)) {
        return getVotes(delegates[user]);  // Can loop forever
    }
    return balanceOf[user];
}
```

### Fix
```solidity
// Track visited addresses to detect cycles
```

---


*Imported from Solodit curated findings*
