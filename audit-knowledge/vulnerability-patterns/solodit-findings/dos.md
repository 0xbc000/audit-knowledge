# Dos Findings (Solodit)

> Denial of service and gas-related vulnerabilities

## Overview

| ID | Severity | Title | Platform |
|----|----------|-------|----------|
| SOL-019 | 游리 medium | Unbounded Loop Over User Array | Sherlock |
| SOL-043 | 游 high | External Call in Loop Causes Revert Propagation | Code4rena |
| SOL-044 | 游리 medium | Block Gas Limit Prevents Withdrawal | Sherlock |
| SOL-071 | 游 high | Array Pop in Loop Modifies Length | Sherlock |
| SOL-072 | 游리 medium | Return Bomb Attack | Code4rena |

---

## SOL-019: Unbounded Loop Over User Array

**Severity:** 游리 MEDIUM  
**Platform:** Sherlock  
**Protocol Type:** Staking Protocol

### Description
Function iterates over all users array which can grow unboundedly.

### Impact
Function becomes uncallable when array grows too large.

### Vulnerable Code
```solidity
function distributeRewards() external {
    for (uint i = 0; i < users.length; i++) {  // Unbounded!
        _sendReward(users[i]);
    }
}
```

### Fix
```solidity
function distributeRewards(uint256 start, uint256 end) external {
    require(end <= users.length && end - start <= 100);
    for (uint i = start; i < end; i++) {
        _sendReward(users[i]);
    }
}
```

---

## SOL-043: External Call in Loop Causes Revert Propagation

**Severity:** 游 HIGH  
**Platform:** Code4rena  
**Protocol Type:** Distribution Protocol

### Description
One failed transfer in loop reverts entire distribution.

### Impact
Single blacklisted address blocks all distributions.

### Vulnerable Code
```solidity
function distribute(address[] calldata recipients) external {
    for (uint i = 0; i < recipients.length; i++) {
        token.transfer(recipients[i], amount);  // One failure = all fail
    }
}
```

### Fix
```solidity
for (uint i = 0; i < recipients.length; i++) {
    try token.transfer(recipients[i], amount) {} 
    catch { failedTransfers.push(recipients[i]); }
}
```

---

## SOL-044: Block Gas Limit Prevents Withdrawal

**Severity:** 游리 MEDIUM  
**Platform:** Sherlock  
**Protocol Type:** Staking Protocol

### Description
Reward calculation iterates through all epochs since deposit.

### Impact
Long-term stakers cannot withdraw due to gas limit.

### Vulnerable Code
```solidity
function claimRewards() external {
    for (uint i = depositEpoch[msg.sender]; i < currentEpoch; i++) {
        rewards += calculateEpochReward(msg.sender, i);
    }
}
```

### Fix
```solidity
// Checkpoint rewards periodically
// Or allow partial claims
```

---

## SOL-071: Array Pop in Loop Modifies Length

**Severity:** 游 HIGH  
**Platform:** Sherlock  
**Protocol Type:** Registry Protocol

### Description
Removing elements while iterating causes skip or out-of-bounds.

### Impact
Some elements never processed, or function reverts.

### Vulnerable Code
```solidity
for (uint i = 0; i < items.length; i++) {
    if (shouldRemove(items[i])) {
        items[i] = items[items.length - 1];
        items.pop();  // Length changes!
    }
}
```

### Fix
```solidity
// Iterate backwards or use separate removal list
```

---

## SOL-072: Return Bomb Attack

**Severity:** 游리 MEDIUM  
**Platform:** Code4rena  
**Protocol Type:** DeFi Protocol

### Description
Malicious contract returns huge data, consuming caller's gas.

### Impact
Operations revert due to return data copy cost.

### Vulnerable Code
```solidity
(bool success, bytes memory data) = target.call(calldata);
// Attacker returns 1MB, consuming gas on copy
```

### Fix
```solidity
// Limit return data size
assembly {
    success := call(gas(), target, 0, add(calldata, 0x20), mload(calldata), 0, 0)
    let size := returndatasize()
    if gt(size, MAX_RETURN) { size := MAX_RETURN }
    data := mload(0x40)
    returndatacopy(add(data, 0x20), 0, size)
}
```

---


*Imported from Solodit curated findings*
